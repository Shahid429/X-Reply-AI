function e(){const e=document.getElementById("notification");e&&(e.style.display="none")}function t(){const e=document.getElementById("status"),t=document.getElementById("statusText"),n=document.getElementById("openOptions"),o=document.getElementById("openTwitter"),c=document.getElementById("version"),s=document.getElementById("themeToggle");c&&(c.textContent="v1.0.0"),s.addEventListener("click",()=>{const e=document.body.classList.toggle("dark-theme");s.textContent=e?"‚òÄÔ∏è":"üåô",s.setAttribute("aria-label",e?"Switch to light theme":"Switch to dark theme"),localStorage.setItem("theme",e?"dark":"light")});"dark"===localStorage.getItem("theme")&&(document.body.classList.add("dark-theme"),s.textContent="‚òÄÔ∏è",s.setAttribute("aria-label","Switch to light theme"));const a=document.querySelectorAll(".preset-card");let i=localStorage.getItem("selectedPreset")||"casual";function r(){a.forEach(e=>{const t=e.dataset.preset===i;e.classList.toggle("active",t)}),localStorage.setItem("selectedPreset",i)}a.forEach(e=>{e.addEventListener("click",()=>{i=e.dataset.preset,r()})}),r(),function(){d("loading","Checking API status...");try{chrome.storage.sync.get(["geminiApiKeys","openaiApiKeys","perplexityApiKeys"],function(e){const t=Array.isArray(e.geminiApiKeys)&&e.geminiApiKeys.length>0,n=Array.isArray(e.openaiApiKeys)&&e.openaiApiKeys.length>0,o=Array.isArray(e.perplexityApiKeys)&&e.perplexityApiKeys.length>0;t||n||o?d("connected","API keys configured and ready!"):d("disconnected","Add at least one API key in settings.")})}catch(e){d("disconnected","Unable to read settings.")}}(),n.addEventListener("click",function(e){e.preventDefault();try{chrome.windows.create({url:"options.html",type:"popup",width:480,height:720})}catch{try{chrome.runtime.openOptionsPage()}catch{}}window.close()});function d(n,o){e.className="status "+n,t.textContent=o;const c=e.querySelector(".status-icon");switch(n){case"connected":c.textContent="‚úÖ";break;case"disconnected":c.textContent="‚ö†Ô∏è";break;case"loading":c.textContent="‚è≥";break;default:c.textContent="‚ÑπÔ∏è"}}document.getElementById("openDashboard").addEventListener("click",function(e){e.preventDefault();try{chrome.windows.create({url:chrome.runtime.getURL("dashboard.html"),type:"popup",width:500,height:700})}catch{console.error("Failed to open dashboard")}window.close()}),o.addEventListener("click",function(e){e.preventDefault();try{chrome.tabs.create({url:"https://twitter.com"})}catch{}window.close()})}document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("notification-close");n&&n.addEventListener("click",e),async function(){try{const t=await fetch("https://shahid429.github.io/tahzeeb-config/config.json"),n=await t.json();if(!n.enabled)throw document.body.innerHTML="<h2>Extension Disabled</h2>",new Error("Extension disabled");if(n.announcement){(await new Promise(e=>chrome.storage.local.get("shownAnnouncements",e))).shownAnnouncements;!function(t){const n=document.getElementById("notification"),o=document.getElementById("notification-text");n&&o&&(o.textContent=t,n.style.display="block",setTimeout(()=>{e()},5e3))}(n.announcement)}n.alert&&console.warn(n.alert);if((await new Promise(e=>chrome.storage.local.get("enteredPassword",e))).enteredPassword!==n.password){const e=prompt(n.message||"Enter password:");if(e!==n.password)throw document.body.innerHTML="<h2>Extension Locked</h2>",new Error("Password incorrect");await new Promise(t=>chrome.storage.local.set({enteredPassword:e},t))}}catch(e){throw console.error("Failed to fetch config:",e),e}}().then(()=>{t()}).catch(e=>{console.error("Config check failed:",e),t()})});